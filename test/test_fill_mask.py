import cv2
import json
import numpy as np


def test_foo():
    # points = json.load(open("p.json"))["point_list"]
    points = [
        [
            13125,
            10851,
            13211,
            10851,
            13276,
            10873,
            13298,
            10873,
            13341,
            10894,
            13341,
            10959,
            16361,
            16783,
            16296,
            16827,
            16081,
            16956,
            15822,
            17085,
            15735,
            17150,
            15088,
            17409,
            15002,
            17452,
            14786,
            17474,
            14700,
            17517,
            14592,
            17539,
            14506,
            17582,
            14247,
            17625,
            14161,
            17646,
            13384,
            17646,
            13298,
            17625,
            13190,
            17625,
            12866,
            17560,
            12737,
            17517,
            12499,
            17452,
            12370,
            17387,
            12262,
            17344,
            12046,
            17280,
            11917,
            17236,
            11831,
            17193,
            11637,
            17085,
            11529,
            17042,
            11442,
            16978,
            11291,
            16848,
            11184,
            16740,
            11119,
            16654,
            10925,
            16417,
            10860,
            16330,
            10795,
            16223,
            10709,
            16093,
            10687,
            16007,
            10558,
            15834,
            10515,
            15748,
            10385,
            15424,
            10278,
            15187,
            10234,
            15058,
            10213,
            14950,
            10083,
            14475,
            10083,
            13008,
            10127,
            12879,
            10127,
            12793,
            10170,
            12663,
            10170,
            12555,
            10191,
            12491,
            10234,
            12404,
            10256,
            12296,
            10299,
            12124,
            10299,
            12059,
            10342,
            11973,
            10385,
            11908,
            10407,
            11843,
            10450,
            11800,
            10472,
            11714,
            10515,
            11671,
            10536,
            11628,
            10687,
            11477,
            10731,
            11455,
            10774,
            11412,
            10838,
            11369,
            10882,
            11347,
            10903,
            11304,
            10989,
            11261,
            11054,
            11239,
            11119,
            11196,
            11184,
            11175,
            11270,
            11153,
            11356,
            11110,
            11421,
            11067,
            11593,
            11024,
            11658,
            10980,
            11723,
            10959,
            11809,
            10937,
            11852,
            10894,
            11917,
            10873,
            11982,
            10873,
            12046,
            10829,
            13060,
            10829,
        ],
        [
            12650,
            13828,
            12629,
            13850,
            12586,
            13871,
            12564,
            13871,
            12413,
            14022,
            12370,
            14044,
            12348,
            14087,
            12305,
            14130,
            12284,
            14173,
            12284,
            14216,
            12241,
            14259,
            12241,
            14324,
            12219,
            14346,
            12197,
            14389,
            12197,
            14410,
            12176,
            14454,
            12154,
            14475,
            12154,
            15079,
            12197,
            15166,
            12241,
            15209,
            12241,
            15230,
            12262,
            15252,
            12305,
            15317,
            12327,
            15360,
            12348,
            15360,
            12413,
            15403,
            12953,
            15403,
            12974,
            15381,
            13017,
            15360,
            13039,
            15338,
            13060,
            15338,
            13211,
            15187,
            13233,
            15144,
            13276,
            15079,
            13362,
            15015,
            13406,
            14950,
            13470,
            14885,
            13492,
            14842,
            13578,
            14756,
            13578,
            14734,
            13600,
            14712,
            13600,
            14648,
            13621,
            14626,
            13621,
            14540,
            13643,
            14518,
            13643,
            14152,
            13621,
            14152,
            13600,
            14130,
            13600,
            14108,
            13578,
            14108,
            13578,
            14087,
            12953,
            13871,
            12953,
            13850,
            12888,
            13850,
            12845,
            13828,
        ],
    ]

    # points = np.array(points).reshape(-1, 2)
    points = [np.array(item).reshape(-1, 2) for item in points]
    xmins = [np.min(item[:, 0]) for item in points]
    ymins = [np.min(item[:, 1]) for item in points]

    xmin = min(xmins)
    ymin = min(ymins)

    xmaxs = [np.max(item[:, 0]) for item in points]
    ymaxs = [np.max(item[:, 1]) for item in points]

    xmax = min(xmaxs)
    ymax = max(ymaxs)

    height = ymax - xmax + 1
    width = xmax - xmin + 1

    for p in points:
        p[:, 0] -= xmin
        p[:, 1] -= ymin

    mask = np.zeros(shape=(height, width), dtype=np.uint8)
    cv2.fillPoly(mask, points, 255)
    cv2.imwrite("foo.png", mask)


def test_bar():
    h = 512
    w = 512

    points = [
        [10, 120],
        [12, 112],
        [13, 108],
        [14, 106],
        [20, 100],
        [25, 97],
        [47, 89],
        [60, 75],
        [80, 63],
        [35, 89],
        [29, 90],
        [12, 109],
    ]

    points = [[10, 50], [300, 200], [50, 500]]

    points = np.array(points, dtype=np.int32)

    mask = np.zeros(shape=(h, w), dtype=np.uint8)

    cv2.fillPoly(mask, [points], 255)
    cv2.imwrite("cute.png", mask)


if __name__ == "__main__":
    test_foo()
